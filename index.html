<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Doce Aventura da Banana Fofa üçåüßÅ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #FFF5F7; /* Rosa pastel bem clarinho */
            font-family: 'Fredoka', sans-serif;
            touch-action: none; /* Previne zoom no celular */
        }

        #gameCanvas {
            display: block;
            width: 100%;
            height: 100vh;
        }

        /* Interface sobreposta */
        .ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px;
            box-sizing: border-box;
        }

        .score-box {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(5px);
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 24px;
            color: #FF6B6B;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.2);
            border: 2px solid #FFE4E1;
            display: inline-block;
        }

        .hearts {
            font-size: 30px;
            letter-spacing: 5px;
        }

        /* Tela de In√≠cio e Game Over */
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 245, 247, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            pointer-events: auto;
            transition: opacity 0.3s;
            z-index: 10;
        }

        .hidden {
            opacity: 0;
            pointer-events: none;
        }

        h1 {
            font-size: 4rem;
            color: #FFB347; /* Laranja Banana */
            text-shadow: 3px 3px 0px #FF6B6B;
            margin-bottom: 10px;
            text-align: center;
            line-height: 1.1;
        }

        p {
            font-size: 1.5rem;
            color: #888;
            margin-bottom: 30px;
            text-align: center;
        }

        button {
            background: linear-gradient(45deg, #FFB347, #FFCC33);
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            color: white;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Fredoka', sans-serif;
            font-weight: 600;
            box-shadow: 0 10px 20px rgba(255, 179, 71, 0.4);
            transition: transform 0.1s, box-shadow 0.1s;
            animation: pulse 2s infinite;
        }

        button:active {
            transform: scale(0.95);
            box-shadow: 0 5px 10px rgba(255, 179, 71, 0.4);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Part√≠culas de fundo para dar clima de doce */
        .bg-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(#FFD1DC 2px, transparent 2px);
            background-size: 30px 30px;
            z-index: -1;
            opacity: 0.5;
        }
    </style>
</head>
<body>

    <div class="bg-pattern"></div>

    <!-- Canvas do Jogo -->
    <canvas id="gameCanvas"></canvas>

    <!-- Interface durante o jogo -->
    <div class="ui-layer" id="gameUI" style="display: none;">
        <div class="flex justify-between w-full">
            <div class="score-box">Doces: <span id="scoreVal">0</span></div>
            <div class="hearts" id="livesVal">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
        </div>
    </div>

    <!-- Tela Inicial -->
    <div class="screen" id="startScreen">
        <h1>Banana<br>Doce & Fofa</h1>
        <p>Ajude a Banana a pegar os docinhos!<br>Cuidado com os br√≥colis ü•¶</p>
        <button onclick="startGame()">Jogar Agora!</button>
    </div>

    <!-- Tela de Game Over -->
    <div class="screen hidden" id="gameOverScreen">
        <h1 style="color: #FF6B6B; text-shadow: none;">Poxa vida!</h1>
        <p>Voc√™ pegou muitos br√≥colis.<br>Sua pontua√ß√£o: <span id="finalScore" class="font-bold text-pink-500">0</span></p>
        <button onclick="startGame()">Tentar de Novo</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Elementos da UI
        const startScreen = document.getElementById('startScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const gameUI = document.getElementById('gameUI');
        const scoreEl = document.getElementById('scoreVal');
        const livesEl = document.getElementById('livesVal');
        const finalScoreEl = document.getElementById('finalScore');

        // Vari√°veis do Jogo
        let gameRunning = false;
        let score = 0;
        let lives = 3;
        let frameCount = 0;
        let particles = [];
        let items = [];
        let difficulty = 1;

        // Ajuste de tamanho
        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // --- CLASSES ---

        // O Jogador (A Banana Fofa)
        class Player {
            constructor() {
                this.x = canvas.width / 2;
                this.y = canvas.height - 100;
                this.width = 60;
                this.height = 80;
                this.targetX = this.x;
                this.angle = 0;
                this.bounce = 0;
            }

            update() {
                // Movimento suave (Lerp)
                this.x += (this.targetX - this.x) * 0.15;
                
                // Efeito de balan√ßo ao mover
                this.angle = (this.x - this.targetX) * 0.005;
                
                // Respira√ß√£o/Pulo (Idle animation)
                this.bounce = Math.sin(Date.now() / 150) * 5;

                // Limites da tela
                if (this.x < 40) this.x = 40;
                if (this.x > canvas.width - 40) this.x = canvas.width - 40;
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y + this.bounce);
                ctx.rotate(this.angle);

                // Desenhar a Banana
                // Corpo
                ctx.beginPath();
                ctx.fillStyle = '#FFEB3B'; // Amarelo Banana
                ctx.strokeStyle = '#FBC02D';
                ctx.lineWidth = 3;
                // Curva da banana
                ctx.moveTo(-20, -40);
                ctx.quadraticCurveTo(30, 0, -20, 40);
                ctx.quadraticCurveTo(-50, 0, -20, -40);
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                // Cabinho da banana
                ctx.beginPath();
                ctx.fillStyle = '#8D6E63';
                ctx.rect(-24, -48, 8, 10);
                ctx.fill();

                // Rosto Fofo (Kawaii)
                // Olhos
                ctx.fillStyle = '#3E2723';
                ctx.beginPath();
                ctx.arc(-15, -10, 3, 0, Math.PI * 2); // Olho esquerdo
                ctx.arc(5, -10, 3, 0, Math.PI * 2); // Olho direito
                ctx.fill();

                // Bochechas (Essencial para ser fofo)
                ctx.fillStyle = 'rgba(255, 105, 180, 0.5)';
                ctx.beginPath();
                ctx.arc(-22, -2, 6, 0, Math.PI * 2);
                ctx.arc(12, -2, 6, 0, Math.PI * 2);
                ctx.fill();

                // Boca Sorridente
                ctx.strokeStyle = '#3E2723';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(-5, -2, 5, 0.2, Math.PI - 0.2);
                ctx.stroke();

                ctx.restore();
            }
        }

        // Itens que caem (Doces e Br√≥colis)
        class Item {
            constructor() {
                this.x = Math.random() * (canvas.width - 60) + 30;
                this.y = -50;
                this.speed = (Math.random() * 2 + 3) * difficulty;
                this.size = 40;
                this.rotation = 0;
                this.rotSpeed = (Math.random() - 0.5) * 0.1;
                
                // Tipos de itens
                const rand = Math.random();
                if (rand < 0.15) {
                    this.type = 'bad'; // 15% de chance de ser br√≥colis
                    this.emoji = 'ü•¶';
                } else if (rand < 0.2) {
                    this.type = 'gold'; // 5% de chance de ser banana dourada
                    this.emoji = 'üçå';
                    this.speed *= 1.5;
                } else {
                    this.type = 'good';
                    // Lista de doces
                    const sweets = ['üç©', 'üßÅ', 'üç≠', 'üç¨', 'üç∞', 'üç™', 'üç´', 'üç¶'];
                    this.emoji = sweets[Math.floor(Math.random() * sweets.length)];
                }
            }

            update() {
                this.y += this.speed;
                this.rotation += this.rotSpeed;
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation);
                ctx.font = "40px Arial";
                ctx.textAlign = "center";
                ctx.textBaseline = "middle";
                
                // Sombra fofa
                ctx.shadowColor = "rgba(0,0,0,0.1)";
                ctx.shadowBlur = 5;
                ctx.shadowOffsetY = 5;
                
                ctx.fillText(this.emoji, 0, 0);
                
                // Brilho se for ouro
                if (this.type === 'gold') {
                    ctx.shadowColor = "gold";
                    ctx.shadowBlur = 20;
                    ctx.fillText('‚ú®', 15, -15);
                }
                
                ctx.restore();
            }
        }

        // Part√≠culas de explos√£o (Confete)
        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.vx = (Math.random() - 0.5) * 10;
                this.vy = (Math.random() - 0.5) * 10;
                this.life = 1; // Opacidade
                this.color = color;
                this.size = Math.random() * 5 + 2;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.vy += 0.2; // Gravidade
                this.life -= 0.02;
            }

            draw() {
                ctx.globalAlpha = this.life;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.globalAlpha = 1;
            }
        }

        // --- L√ìGICA DO JOGO ---

        const player = new Player();

        // Input (Mouse e Touch)
        function handleInput(e) {
            let clientX;
            if (e.touches) {
                clientX = e.touches[0].clientX;
            } else {
                clientX = e.clientX;
            }
            player.targetX = clientX;
        }

        window.addEventListener('mousemove', handleInput);
        window.addEventListener('touchmove', handleInput);

        function createExplosion(x, y, type) {
            let colors = ['#FF69B4', '#FFFACD', '#87CEEB', '#FFD1DC'];
            if (type === 'bad') colors = ['#4CAF50', '#2E7D32']; // Verde feio
            if (type === 'gold') colors = ['#FFD700', '#FFF']; // Dourado
            
            for (let i = 0; i < 15; i++) {
                particles.push(new Particle(x, y, colors[Math.floor(Math.random() * colors.length)]));
            }
        }

        function startGame() {
            score = 0;
            lives = 3;
            difficulty = 1;
            items = [];
            particles = [];
            gameRunning = true;
            scoreEl.innerText = score;
            livesEl.innerText = "‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è";
            
            startScreen.classList.add('hidden');
            gameOverScreen.classList.add('hidden');
            gameUI.style.display = 'flex';

            animate();
        }

        function gameOver() {
            gameRunning = false;
            gameUI.style.display = 'none';
            gameOverScreen.classList.remove('hidden');
            finalScoreEl.innerText = score;
        }

        function animate() {
            if (!gameRunning) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            frameCount++;

            // Gerar itens
            // Diminui o intervalo conforme a dificuldade aumenta
            let spawnRate = Math.max(20, 60 - Math.floor(score / 5));
            if (frameCount % spawnRate === 0) {
                items.push(new Item());
            }

            // Aumentar dificuldade suavemente
            difficulty = 1 + (score * 0.01);

            // Atualizar Jogador
            player.update();
            player.draw();

            // Atualizar Itens
            for (let i = items.length - 1; i >= 0; i--) {
                let item = items[i];
                item.update();
                item.draw();

                // Colis√£o simples (Dist√¢ncia)
                const dx = item.x - player.x;
                const dy = item.y - (player.y - 20); // Centro aproximado da banana
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < 60) {
                    // Pegou!
                    if (item.type === 'bad') {
                        createExplosion(item.x, item.y, 'bad');
                        lives--;
                        // Atualizar cora√ß√µes
                        livesEl.innerText = "‚ù§Ô∏è".repeat(lives) + "ü§ç".repeat(3 - lives);
                        // Tremor na tela (opcional)
                        canvas.style.transform = "translate(5px, 5px)";
                        setTimeout(() => canvas.style.transform = "none", 100);
                        
                        if (lives <= 0) {
                            gameOver();
                        }
                    } else {
                        createExplosion(item.x, item.y, item.type);
                        let points = item.type === 'gold' ? 5 : 1;
                        score += points;
                        scoreEl.innerText = score;
                        
                        // Efeito visual de pontua√ß√£o flutuante (simplificado aqui)
                    }
                    items.splice(i, 1);
                } else if (item.y > canvas.height) {
                    // Passou da tela
                    items.splice(i, 1);
                }
            }

            // Atualizar Part√≠culas
            for (let i = particles.length - 1; i >= 0; i--) {
                let p = particles[i];
                p.update();
                p.draw();
                if (p.life <= 0) particles.splice(i, 1);
            }

            requestAnimationFrame(animate);
        }

        // Iniciar desenho inicial (fundo)
        ctx.fillStyle = '#FFF5F7';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

    </script>
</body>
</html>
